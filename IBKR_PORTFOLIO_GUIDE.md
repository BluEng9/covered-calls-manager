# 🎯 מדריך שימוש בתיק IBKR - Covered Calls Manager

**תאריך:** 2025-10-06
**גרסה:** 1.0

---

## 📊 התיק שלך (מתוך PDF)

### נכסים נוכחיים:
| מניה | כמות | מחיר ממוצע | מחיר נוכחי | רווח/הפסד | אחוז |
|------|------|------------|------------|-----------|------|
| **TSLA** | 19 | $260.00 | $248.50 | -$218.50 | -4.42% |
| **MSTY** | 450 | $23.50 | $21.80 | -$765.00 | -7.23% |

**סה"כ ערך:** ~$14,750
**סה"כ הפסד:** -$983.50 (-6.27%)

---

## 🎮 שלושה מצבים לבחירה

### 1️⃣ **מצב LIVE - חיבור ל-IBKR אמיתי**
- **מתי להשתמש:** כשרוצה לראות תיק אמיתי ולבצע עסקאות
- **דרישות:**
  - ✅ TWS/Gateway פתוח ורץ על פורט 7497
  - ✅ API מופעל ב-TWS (Global Configuration > API > Enable ActiveX and Socket Clients)
  - ✅ חשבון מחובר ב-TWS

- **בעיה ידועה:** כרגע TWS מראה 0 פוזיציות
  - **פתרון 1:** ודא שאתה רואה TSLA ו-MSTY ב-TWS Portfolio
  - **פתרון 2:** בדוק שה-TWS מחובר לאותו חשבון מה-PDF
  - **פתרון 3:** לפעמים לוקח זמן ל-TWS לסנכרן - חכה כמה דקות

### 2️⃣ **מצב DEMO - העלאת CSV** ⭐ **מומלץ כרגע!**
- **מתי להשתמש:** כשרוצה לבדוק אסטרטגיות על התיק שלך ללא סיכון
- **יתרונות:**
  - ✅ עובד תמיד (לא תלוי ב-TWS)
  - ✅ בטוח - אי אפשר לבצע עסקאות בטעות
  - ✅ מהיר - לא צריך לחכות לחיבור TWS

- **איך להשתמש:**
  1. פתח http://localhost:8504
  2. בחר **"Demo Mode (CSV Upload)"** בסרגל צד
  3. העלה את הקובץ: `my_ibkr_portfolio.csv`
  4. בחר TSLA מהרשימה
  5. נסה אסטרטגיות שונות!

### 3️⃣ **מצב DEMO - נתונים מדומים**
- **מתי להשתמש:** כשרוצה לראות איך המערכת עובדת בכלל
- **יתרונות:** תיק דמו מוכן עם AAPL, MSFT, TSLA, NVDA

---

## 🚀 התחלה מהירה (3 צעדים)

### צעד 1: הרץ את הדשבורד
```bash
cd ~/Projects/TradingBots/covered-calls-manager
source venv/bin/activate
streamlit run dashboard.py --server.port 8504 --server.headless true
```

### צעד 2: פתח דפדפן
```
http://localhost:8504
```

### צעד 3: בחר מצב Demo (CSV Upload)
1. לחץ על **"Demo Mode (CSV Upload)"** בסרגל שמאל
2. לחץ על **"Browse files"**
3. בחר: `my_ibkr_portfolio.csv`
4. לחץ **"Load Portfolio"**

🎉 **זהו! עכשיו אתה רואה את התיק שלך במערכת**

---

## 📈 אסטרטגיות Covered Call מומלצות ל-TSLA

### 🔷 אסטרטגיה 1: **שמרנית - "חכה לרווח"**
**מטרה:** להרוויח פרמיה בזמן שמחכה ש-TSLA תעלה

**הגדרות:**
- Strike: **$260-270** (מעל המחיר הממוצע שלך)
- Expiration: **30-45 ימים**
- Expected Premium: **$2-4 למניה** = $38-76 סה"כ

**יתרונות:**
- ✅ אם TSLA לא עולה - מרוויח פרמיה
- ✅ אם TSLA עולה מעט - מרוויח פרמיה + רווח על המניה
- ✅ סיכון נמוך

**חסרונות:**
- ⚠️ אם TSLA עולה מהר מעל $270 - מפספס רווח נוסף
- ⚠️ אם TSLA יורדת - עדיין בהפסד (אבל יש פרמיה)

**דוגמה:**
```
מצב נוכחי: TSLA @ $248.50
מוכר Call Strike $265 @ $3.50 פרמיה
תוצאות אפשריות:
1. TSLA נשאר מתחת ל-$265 → מרוויח $66.50 פרמיה
2. TSLA עולה ל-$265 → מרוויח $66.50 + $313.50 (מכירה) = $380
3. TSLA עולה ל-$280 → מרוויח רק $380 (מפספס $285 נוספים)
```

### 🔷 אסטרטגיה 2: **אגרסיבית - "הכנסה גבוהה"**
**מטרה:** למקסם הכנסה חודשית, גם אם זה אומר למכור בהפסד

**הגדרות:**
- Strike: **$250-255** (קרוב למחיר נוכחי)
- Expiration: **14-21 ימים**
- Expected Premium: **$5-8 למניה** = $95-152 סה"כ

**יתרונות:**
- ✅ פרמיה גבוהה מאוד
- ✅ ניתן לחזור כל 2-3 שבועות
- ✅ פוטנציאל ל-$300-600 הכנסה חודשית

**חסרונות:**
- ⚠️ סיכוי גבוה למכור בהפסד ($250-255 מתחת למחיר שלך $260)
- ⚠️ אם TSLA עולה מהר - מפספס רווח גדול

**למי זה מתאים:**
- אם לא מאמין ש-TSLA תעלה בטווח הקרוב
- אם מעדיף הכנסה קבועה על פני רווחי הון
- אם מוכן לקחת הפסד על TSLA

### 🔷 אסטרטגיה 3: **המתנה - "אל תמכור כלום"**
**מטרה:** להמתין ש-TSLA תחזור מעל $260

**מתי להשתמש:**
- ✅ אם אתה שורי על TSLA לטווח ארוך
- ✅ אם אין צורך בהכנסה מיידית
- ✅ אם מוכן לחכות 3-6 חודשים

**אז מתי למכור Call?**
1. **כש-TSLA עולה מעל $260:**
   - מכור Strike $270-280
   - פרמיה תהיה יותר גבוהה
   - תמכור ברווח

2. **כש-TSLA עולה 5%+ ביום אחד:**
   - Implied Volatility עולה
   - פרמיות יותר גבוהות
   - זמן טוב למכור

---

## 🎯 בחירת Strike ו-Expiration - מדריך מלא

### 📊 Strike Price - בחירה חכמה

#### **Strike גבוה ($270-280)**
- **פרמיה:** נמוכה ($1-2)
- **סיכוי לפקיעה ITM:** נמוך (5-15%)
- **מתאים אם:** שורי, רוצה להחזיק את המניה
- **דוגמה:** Strike $275 @ $1.50 → רק $28.50 הכנסה אבל סיכוי קטן למכירה

#### **Strike בינוני ($260-270)**
- **פרמיה:** בינונית ($2-4)
- **סיכוי לפקיעה ITM:** בינוני (20-40%)
- **מתאים אם:** ניטרלי, רוצה איזון
- **דוגמה:** Strike $265 @ $3.00 → $57 הכנסה, סיכוי בינוני למכירה

#### **Strike נמוך ($250-260)**
- **פרמיה:** גבוהה ($5-8)
- **סיכוי לפקיעה ITM:** גבוה (50-70%)
- **מתאים אם:** דובי, רוצה להיפטר מהמניה
- **דוגמה:** Strike $255 @ $6.00 → $114 הכנסה, סיכוי גבוה למכירה

### 📅 Expiration - בחירת תאריך

#### **קצר טווח (7-14 ימים)**
- ✅ Theta Decay מהיר (פרמיה מתאדה מהר)
- ✅ גמישות - יכול לשנות אסטרטגיה מהר
- ✅ פרמיה גבוהה יחסית לזמן
- ⚠️ צריך לעקוב כל שבוע
- ⚠️ עמלות גבוהות יותר (יותר עסקאות)

#### **בינוני טווח (30-45 ימים)**
- ✅ איזון טוב בין פרמיה לזמן
- ✅ פחות עסקאות = פחות עמלות
- ✅ פחות לחץ
- ⚠️ Theta Decay יותר איטי
- ⚠️ פחות גמישות

#### **ארוך טווח (60-90 ימים)**
- ✅ פרמיה גבוהה ($8-15 למניה)
- ✅ צריך להתעסק פעם בחודשיים
- ⚠️ נעילה ארוכה
- ⚠️ אם המניה עולה מהר - מפספס הרבה רווח

---

## 🧮 מחשבונים מובנים

### 1. **Calculator Tab** בדשבורד
- שים Strike Price ו-Premium
- רואה מיד:
  - Max Profit
  - Break-even Point
  - Profit at different stock prices
  - Return %

### 2. **Strategy Finder Tab**
- המערכת מחפשת בשבילך את האסטרטגיות הטובות ביותר
- מציגה 10 האופציות הכי רווחיות
- כולל Risk Analysis אוטומטי

---

## ⚠️ חשוב לגבי MSTY!

### מה זה MSTY?
**YieldMax MSTR Option Income Strategy ETF** - זה ETF שמשקיע באופציות על MSTR (MicroStrategy)

### למה לא לעשות Covered Calls על MSTY?
1. ❌ **זה כבר מוצר אופציות** - אתה בעצם מוכר אופציה על אופציה
2. ❌ **Implied Volatility מאוד גבוה** - קשה למחר מחיר נכון
3. ❌ **Liquidity נמוכה** - פחות קונים ומוכרים
4. ❌ **Bid-Ask Spread רחב** - תשלם יותר בעמלות

### מה לעשות עם MSTY?
**אופציה 1: להמתין**
- אם אתה מאמין ב-MSTR לטווח ארוך
- הדיבידנדים החודשיים יעזרו לכסות הפסד

**אופציה 2: למכור**
- אם אתה לא מבין את המוצר (זה מורכב!)
- 450 מניות × $21.80 = $9,810
- הפסד: -$765 (7.23%)
- שקול להשקיע מחדש ב-TSLA או מניה אחרת

**אופציה 3: לקנות עוד**
- אם המחיר יורד מתחת ל-$20
- Average down את המחיר
- **אבל רק אם אתה מבין את המוצר!**

---

## 🔧 כלים נוספים שיצרתי לך

### 1. **ibkr_portfolio_converter.py**
**מה זה עושה:** מנתח את ה-PDF של IBKR ויוצר CSV

**איך להריץ:**
```bash
cd ~/Projects/TradingBots/covered-calls-manager
source venv/bin/activate
python ibkr_portfolio_converter.py
```

**תוצאה:** `my_ibkr_portfolio.csv` - מוכן לשימוש!

### 2. **my_ibkr_portfolio.csv**
**הקובץ שלך:**
```csv
Symbol,Quantity,AvgCost,CurrentPrice
TSLA,19,260.0,248.5
MSTY,450,23.5,21.8
```

**איך לעדכן מחירים:**
1. פתח את הקובץ בטקסט אדיטור
2. שנה את `CurrentPrice` למחיר הנוכחי
3. שמור
4. העלה מחדש לדשבורד

---

## 🎓 כלים שאני יכול לבנות בעתיד

### 1. **📊 Real-time Price Updater**
```python
# עדכון מחירים אוטומטי כל 5 דקות
# חיבור ל-API חינמי (Yahoo Finance / Alpha Vantage)
# עדכון CSV אוטומטי
```

### 2. **🔔 Smart Alerts**
```python
# התראות כש:
# - TSLA עולה מעל $260 (cost basis שלך)
# - פרמיה על Strike $270 עולה מעל $4
# - IV Percentile מעל 70 (זמן טוב למכור)
```

### 3. **📈 Backtester**
```python
# בדיקה היסטורית:
# "מה היה קורה אם מכרתי Strike $260 כל חודש ב-6 חודשים אחרונים?"
# הצגה: רווח/הפסד כולל, win rate, סה"כ פרמיה
```

### 4. **📑 Tax Report Generator**
```python
# דוח אוטומטי לצורכי מס:
# - הכנסה מפרמיות
# - רווח/הפסד ממכירת מניות
# - ייצוא לאקסל למס הכנסה
```

### 5. **🎯 Position Optimizer**
```python
# אופטימיזציה אוטומטית:
# קלט: "אני שורי בינוני, רוצה $200 חודש"
# פלט: "מכור Strike $265, 30 ימים, פרמיה $3.20"
```

### 6. **📊 Portfolio Dashboard**
```python
# תצוגה מקיפה:
# - סה"כ ערך תיק
# - P&L לפי מניה
# - היסטוריית Covered Calls
# - ROI שנתי
```

---

## 🐛 פתרון בעיות

### ❌ "Failed to connect to IBKR"
**פתרון:**
1. ודא TWS/Gateway רץ
2. בדוק שפורט 7497 פתוח: `lsof -i:7497`
3. הפעל API ב-TWS: File → Global Configuration → API Settings
4. אפשר "Enable ActiveX and Socket Clients"

### ❌ "No positions found" (בחיבור LIVE)
**פתרון:**
1. ודא שאתה רואה את המניות ב-Portfolio של TWS
2. חכה 30 שניות - לפעמים לוקח זמן לסנכרן
3. נסה להתנתק ולהתחבר מחדש ב-TWS
4. **זמני: השתמש במצב CSV עד שהבעיה נפתרת**

### ❌ "Error: The future belongs to a different loop"
**פתרון:**
זה תוקן! אם אתה עדיין רואה את זה:
```bash
# עדכן את ibkr_connector.py
git pull
# או
pip install --upgrade ib_async
```

### ❌ Dashboard לא נפתח
**פתרון:**
```bash
# הרוג תהליכים ישנים
killall -9 streamlit

# הרץ מחדש
cd ~/Projects/TradingBots/covered-calls-manager
source venv/bin/activate
streamlit run dashboard.py --server.port 8504 --server.headless true

# פתח דפדפן
open http://localhost:8504
```

---

## 📞 תמיכה ועזרה

### רוצה עזרה? שאל אותי:
1. **"תבדוק אסטרטגיה ספציפית"**
   - דוגמה: "מה אם אני מוכר TSLA Strike $270 ב-30 ימים?"

2. **"תבנה כלי נוסף"**
   - דוגמה: "תבנה לי backtester עבור TSLA"

3. **"תסביר משהו"**
   - דוגמה: "מה זה IV Percentile ואיך אני משתמש בזה?"

4. **"תתקן בעיה"**
   - דוגמה: "הדשבורד לא נפתח"

---

## 🎯 סיכום - מה לעשות עכשיו?

### ✅ צעדים מיידיים:
1. **הרץ את הדשבורד** (אם לא רץ)
2. **בחר Demo Mode (CSV Upload)**
3. **העלה את my_ibkr_portfolio.csv**
4. **נסה אסטרטגיה שמרנית על TSLA:**
   - Strike: $265
   - Expiration: 30 days
   - בדוק מה המודל ממליץ

### 📚 צעדים הבאים (השבוע):
1. **למד על Covered Calls:**
   - קרא סעיף "בחירת Strike ו-Expiration"
   - נסה 3-4 אסטרטגיות שונות בדשבורד
   - רשום מה היית עושה בפועל

2. **תקן את TWS (אם רלוונטי):**
   - ודא שאתה רואה TSLA ו-MSTY ב-Portfolio
   - נסה להתחבר במצב LIVE

3. **החלט לגבי MSTY:**
   - למכור? להמתין? לקנות עוד?
   - תלוי באסטרטגיה הכוללת שלך

### 🚀 צעדים ארוכי טווח (החודש):
1. **מכור את ה-Covered Call הראשון שלך** (באמת!)
   - התחל קטן - Strike $265-270
   - 30-45 ימים
   - עקוב אחרי התוצאה

2. **בקש ממני לבנות כלי נוסף:**
   - Backtester? Alerts? Tax Report?
   - תגיד לי מה הכי יעזור לך

---

**🎉 בהצלחה עם Covered Calls! 🎉**

**זכור:** זה לא המלצה להשקעה - רק הסבר טכני איך המערכת עובדת.
תמיד עשה מחקר משלך ושקול להתייעץ עם יועץ פיננסי.

---

**📧 שאלות? תכתוב לי בצ'אט!**
